<p-card>
  <ng-template #title>
    <div class="title-container">
      <i class="ti ti-heart-handshake icon"></i>
      Lawn Health Score
      @if (isAiGenerated()) {
        <p-button
          #aiIndicator
          [text]="true"
          [rounded]="true"
          size="small"
          class="ai-indicator"
          (click)="op.toggle($event)"
          icon="ti ti-sparkles"
          severity="secondary"
          [style]="{ marginLeft: 'auto' }"
        />
        <p-popover #op>
          <div class="ai-popover-content">
            <div class="ai-popover-header">
              <i class="ti ti-sparkles ai-icon"></i>
              <span class="ai-title">AI Generated</span>
            </div>
            <p class="ai-description">
              This description was generated by AI based on your lawn health
              score and current season. Please note that AI-generated content
              may not always be accurate or applicable to your specific lawn
              conditions.
            </p>
          </div>
        </p-popover>
      }
    </div>
  </ng-template>
  <div class="health-score-container">
    <div class="score-display">
      <div class="score-circle" [style.border-color]="scoreColor()">
        <span class="score-number">{{ lawnHealthScore().totalScore }}</span>
        <span class="score-grade">{{ lawnHealthScore().grade }}</span>
      </div>
      <p class="score-description">{{ finalDescription() }}</p>
    </div>
    <p-divider [dt]="dividerDt" />
    <div class="breakdown-container">
      <div class="breakdown-item">
        <span class="breakdown-label">
          <i class="li li-lawnmower breakdown-icon"></i>
          Mowing
        </span>
        <span class="breakdown-score"
          >{{ lawnHealthScore().mowingScore }}/30</span
        >
      </div>
      <div class="breakdown-item">
        <span class="breakdown-label">
          <i class="ti ti-package breakdown-icon"></i>
          Fertilization
        </span>
        <span class="breakdown-score"
          >{{ lawnHealthScore().fertilizationScore }}/25</span
        >
      </div>
      <div class="breakdown-item">
        <span class="breakdown-label">
          <i class="ti ti-calendar-check breakdown-icon"></i>
          Consistency
        </span>
        <span class="breakdown-score"
          >{{ lawnHealthScore().consistencyScore }}/20</span
        >
      </div>
      <div class="breakdown-item">
        <span class="breakdown-label">
          <i class="ti ti-clock breakdown-icon"></i>
          Recency
        </span>
        <span class="breakdown-score"
          >{{ lawnHealthScore().recencyScore }}/25</span
        >
      </div>
    </div>
  </div>
</p-card>
